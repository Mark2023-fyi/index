<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Itinerario: Austin a Medellín</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Roboto+Mono:wght@700&display=swap');
        body{font-family:'Poppins',sans-serif;background-color:#f0f2f5;color:#333;margin:0;padding:20px}.container{max-width:800px;margin:0 auto}h1,h2,h3{text-align:center;color:#1c2a39}h1{font-size:2.2em;margin-bottom:15px}h2{font-size:1.5em;margin:40px 0 20px;color:#007bff}.header-info{text-align:center;margin-bottom:30px;color:#555}.update-notice{font-size:1em;font-weight:600;margin:0 0 5px 0;display:flex;justify-content:center;align-items:center;gap:8px}.timestamp{font-size:0.8em;color:#777;margin:0}.countdown-container,.weather-container{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around;gap:15px;margin-bottom:15px}.countdown-card{background:#1d2b38;color:#fff;padding:20px;border-radius:12px;text-align:center;box-shadow:0 8px 20px rgba(0,0,0,.15);flex:1;min-width:280px;min-height:105px;display:flex;flex-direction:column;justify-content:center}.countdown-card h3{margin-top:0;margin-bottom:10px;font-size:1.1em;font-weight:400;color:#00aaff}.countdown-card .arrival-date{margin:-5px 0 15px 0;font-size:0.85em;color:#9ab;opacity:0.9}.timer{display:flex;justify-content:center;gap:15px;font-family:'Roboto Mono',monospace}.time-block{display:flex;flex-direction:column;min-width:55px}.time-block span:first-child{font-size:2.2em;font-weight:700;color:#f0f2f5;line-height:1}.time-block span:last-child{font-size:.7em;text-transform:uppercase;color:#9ab}.timeline{position:relative;padding:20px 0}.timeline::before{content:'';position:absolute;top:0;left:21px;height:100%;width:4px;background:#e0e0e0}.timeline-item{padding:10px 40px;position:relative;margin-left:25px;margin-bottom:20px}.timeline-item::before{content:attr(data-icon);position:absolute;left:-28px;top:50%;transform:translateY(-50%);width:56px;height:56px;border-radius:50%;background:#fff;border:3px solid #007bff;text-align:center;line-height:56px;font-size:2.5em}.item-content{background:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.08)}.item-date{font-weight:600;color:#007bff;font-size:1.1em;margin-bottom:8px;display:flex;align-items:center;flex-wrap:wrap;gap:5px}.tbd{color:#7f8c8d;font-style:italic}
        .flight-tracker{border-top:1px solid #eee;margin-top:15px;padding-top:15px;display:flex;flex-direction:column;gap:10px;align-items:center}
        .flight-tracker h4{margin:0 0 5px 0;font-weight:600;color:#333;display:flex;align-items:center;gap:8px}
        .live-indicator{display:inline-block;width:10px;height:10px;background-color:#ff4d4d;border-radius:50%;animation:blinker 1.5s linear infinite}@keyframes blinker{50%{opacity:0}}.flight-buttons{display:flex;flex-wrap:wrap;gap:15px;justify-content:center}
        .flight-info{display:flex;flex-direction:column;align-items:center}
        .flight-button{display:inline-block;background-color:#007bff;color:#fff;padding:8px 15px;border-radius:5px;text-decoration:none;font-weight:500;font-size:0.9em;transition:background-color .2s,transform .2s}.flight-button:hover{background-color:#0056b3;transform:translateY(-2px)}
        .flight-route{font-size:0.8em;color:#555;margin-top:4px}
        .info-card{background-color:#fff;border-radius:8px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.08);margin-bottom:20px}.info-card h3{margin-top:0;color:#007bff}.info-card ul{padding-left:20px;margin:0}
        .weather-card{background:#fff;border:1px solid #ddd;padding:10px 15px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08);flex:1;min-width:260px;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.weather-card-left{text-align:left}.weather-card .city{font-weight:600;font-size:1em;margin:0}.weather-card .time{font-family:'Roboto Mono',monospace;font-size:1.1em;margin:2px 0 0 0;color:#555}.weather-card-right{display:flex;align-items:center;gap:8px}.weather-card .icon{font-size:2em;line-height:1}.weather-card .temp{font-size:1.2em;font-weight:600}
        .label-cambio, .label-nuevo, .label-cumple{color:#fff;padding:2px 8px;border-radius:10px;font-size:0.65em;font-weight:700;margin-left:5px;text-transform:uppercase;}
        .label-cambio{background-color:#ff9800;} .label-nuevo{background-color:#4CAF50;} .label-cumple{background-color:#E91E63;}
        .festivo-item > .item-content, .calendar-day.festivo-item{background-color:#e3f2fd;}
        .popup-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:1000;display:flex;justify-content:center;align-items:center;padding:20px;box-sizing:border-box;opacity:0;visibility:hidden;transition:opacity .3s,visibility .3s}.popup-visible{opacity:1!important;visibility:visible!important}.popup-content{background:#fff;padding:20px 30px 30px;border-radius:10px;box-shadow:0 5px 25px rgba(0,0,0,.3);position:relative;max-width:450px;width:100%;text-align:center;transform:scale(.9);transition:transform .3s}.popup-visible .popup-content{transform:scale(1)}.popup-content h2{margin-top:0}.close-popup{position:absolute;top:10px;right:15px;font-size:28px;font-weight:700;color:#aaa;cursor:pointer;transition:color .2s}.close-popup:hover{color:#333}
        .view-switcher{display:flex;justify-content:center;margin-bottom:30px;background:#e0e0e0;border-radius:10px;padding:5px}
        .view-switcher button{border:none;padding:10px 20px;font-family:'Poppins',sans-serif;font-size:1em;font-weight:600;background:transparent;color:#555;border-radius:8px;cursor:pointer;transition:all .3s ease}
        .view-switcher button.active{background:#fff;color:#007bff;box-shadow:0 2px 5px rgba(0,0,0,.1)}
        .view-hidden{display:none}
        .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#ccc;border:1px solid #ccc;border-radius:8px;overflow:hidden}
        .calendar-header{font-weight:600;text-align:center;padding:8px 0;font-size:0.9em;background:#f8f9fa}
        .calendar-day{background:#fff;min-height:80px;padding:4px;font-size:0.8em;display:flex;flex-direction:column}
        .calendar-day.other-month{background:#f9f9f9;color:#ccc}
        .calendar-day.has-events{cursor:pointer;transition:background .2s}.calendar-day.has-events:hover{background:#f1f8ff}
        .calendar-day .day-number{font-weight:600;margin-bottom:5px;text-align:right}
        .event-icons-container{display:flex;flex-wrap:wrap;gap:5px;justify-content:center;padding:0 2px;margin-top:4px}
        .calendar-emoji{font-size:1.6em;line-height:1}
        .calendar-label{margin-top:auto;align-self:center;padding-bottom:4px}
        #modal-events .item-description{text-align:left;font-size:1.1em;line-height:1.6;margin-bottom:15px}#modal-events .item-description:last-child{margin-bottom:0}#modal-events .flight-tracker{font-size:1rem}
        .modal-close-button{border:none;background:#007bff;color:#fff;padding:10px 25px;font-size:1em;font-weight:600;border-radius:5px;margin-top:20px;cursor:pointer;transition:background .2s}.modal-close-button:hover{background:#0056b3}
        .effect-day > .item-content{position:relative; overflow:hidden;}
        .effect-canvas{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1}
    </style>
</head>
<body>

    <div id="privacy-popup" class="popup-overlay">
        <div class="popup-content">
            <span class="close-popup">&times;</span>
            <h2 style="color:#ffc107">⚠️ ¡Cuidado!</h2>
            <p>Para uso interno solamente. El link es abierto y cualquiera puede acceder y ver su información.</p>
            <p style="font-size:0.8em; color:#777;">(Este mensaje desaparecerá el 4 de enero, 2026).</p>
            <button class="modal-close-button">OK</button>
        </div>
    </div>
    
    <div id="calendar-modal" class="popup-overlay">
        <div class="popup-content">
            <span class="close-popup">&times;</span>
            <h2 id="modal-date"></h2>
            <div id="modal-events"></div>
            <button class="modal-close-button">OK</button>
        </div>
    </div>

    <div class="container">
        <h1>🤠 De Austin a Medellín 🇨🇴</h1>

        <div class="header-info">
            <h4 class="update-notice"><span class="live-indicator"></span>Itinerario en Vivo</h4>
            <p class="timestamp">Última actualización: 21 de agosto de 2025, 3:35 PM</p>
        </div>

        <div class="countdown-container">
            <div class="countdown-card" id="card-nathan"></div>
            <div class="countdown-card" id="card-ron-anyela"></div>
        </div>
        
        <div class="weather-container">
            <div id="weather-austin" class="weather-card">Cargando...</div>
            <div id="weather-medellin" class="weather-card">Cargando...</div>
        </div>

        <div class="view-switcher">
            <button id="show-timeline" class="active">Línea de Tiempo</button>
            <button id="show-calendar">Calendario</button>
        </div>

        <div class="timeline" id="timeline-view"></div>
        <div id="calendar-view" class="view-hidden"></div>

        <div class="info-cards-container">
            <h2>Información Adicional</h2>
            <div class="info-card"><h3>📝 Notas Importantes</h3><ul><li><strong>¡PRIVADO!</strong> Maria Helena, Yedinson, y Yazmin ya saben.</li><li>Faber, Yisela, y Rosita no saben absolutamente nada.</li></ul></div>
            <div class="info-card"><h3>🎲 Actividades Planeadas</h3><ul><li>Bingo</li><li>Regalos con la letra "V" de un valor de $10,000 pesos</li><li>Scavenger Hunt (Búsqueda del tesoro)</li><li>Pictionary</li></ul></div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const itineraryData = [
                { date: '2025-12-13', icon: '🛬', description: '<strong>PM:</strong> LLegada de Nathan a Medellin desde USA.', type: 'event-flight', flightInfo: { title: 'Llegada de Nathan', flights: [{ num: 'CM716', route: 'Austin → Panamá' }, { num: 'CM155', route: 'Panamá → Medellín' }]}},
                { date: '2025-12-14', icon: '🏠', description: 'Descanso y actividades.', type: 'event-tbd', label: 'Cambio' },
                { date: '2025-12-15', icon: '🏠', description: 'Descanso y actividades.', type: 'event-tbd', label: 'Cambio' },
                { date: '2025-12-16', icon: '🚗', description: '<strong>AM</strong> - Salida de Nathan de Medellin para el Bogota/Meta.', type: 'event-travel', label: 'Cambio' },
                { date: '2025-12-17', icon: '⛰️', description: 'Estadía fuera de Medellín. Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-18', icon: '⛰️', description: 'Estadía fuera de Medellín. Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-19', icon: '⛰️', description: 'Estadía fuera de Medellín. Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-20', icon: '⛰️', description: 'Estadía fuera de Medellín. Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-21', icon: '⛰️', description: 'Estadía fuera de Medellín. Planes por determinar.', type: 'event-tbd', label: 'Cambio' },
                { date: '2025-12-22', icon: '🏠', description: 'Regreso de Nathan a Medellin.', type: 'event-flight', label: 'Cambio', flightInfo: { title: 'Regreso de Nathan', flights: [{ num: 'EFY821', route: 'Villavicencio → Medellín' }]}},
                { date: '2025-12-23', icon: '📍', description: 'Planes por determinar en Medellín.', type: 'event-tbd' },
                { date: '2025-12-24', icon: '🎄', description: 'Celebración de Nochebuena 🎅', type: 'event-holiday', isHoliday: true },
                { date: '2025-12-25', icon: '🎁', description: 'Día de Navidad 🌟', type: 'event-holiday', isHoliday: true },
                { date: '2025-12-26', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-27', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-28', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-29', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-30', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2025-12-31', icon: '🎉', description: 'Celebración de Fin de Año 🥂', type: 'event-holiday', isHoliday: true },
                { date: '2026-01-01', icon: '🥂', description: 'Día de Año Nuevo. Descanso. 🎉', type: 'event-holiday', isHoliday: true },
                { date: '2026-01-02', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2026-01-03', icon: '🛬', description: '<strong>PM:</strong> Llegada de Ron y Anyela a Medellín desde USA.', type: 'event-flight', flightInfo: { title: 'Llegada de Ron y Anyela', flights: [{ num: 'CM716', route: 'Austin → Panamá' }, { num: 'CM155', route: 'Panamá → Medellín' }]}},
                { date: '2026-01-04', icon: '👨‍👩‍👧‍👦', description: 'Primer encuentro familiar. Almuerzo (hora por definir).', type: 'event-celebration' },
                { date: '2026-01-05', icon: '📍', description: 'Planes por determinar.', type: 'event-tbd' },
                { date: '2026-01-06', icon: '🏙️', description: 'Tiempo para explorar Medellín.', type: 'event-tbd' },
                { date: '2026-01-07', icon: '🏙️', description: 'Tiempo para explorar Medellín.', type: 'event-tbd' },
                { date: '2026-01-08', icon: '🚌', description: '<strong>AM:</strong> Tiempo para explorar en Medellin.<br><strong>PM:</strong> Salida - Bus - Grupo completo para Algeciras.', type: 'event-travel' },
                { date: '2026-01-09', icon: '☀️', description: '<strong>AM:</strong> Llegada del grupo en bus a Algeciras.', type: 'event-travel' },
                { date: '2026-01-10', icon: '⛰️', description: 'Día en Algeciras. Planes por determinar.', type: 'event-tbd' },
                { date: '2026-01-11', icon: '⛰️', description: 'Día en Algeciras. Planes por determinar.', type: 'event-tbd' },
                { date: '2026-01-12', icon: '🎊', description: 'Día en Algeciras (Día Festivo 🎊). Planes por determinar.', type: 'event-holiday', isHoliday: true },
                { date: '2026-01-13', icon: '⛰️', description: 'Día en Algeciras. Planes por determinar.', type: 'event-tbd' },
                { date: '2026-01-14', icon: '🚌', description: '<strong>PM:</strong> Salida - Bus - Grupo completo para Medellin.', type: 'event-travel' },
                { date: '2026-01-15', icon: '🎂', description: '<strong>AM:</strong> Llegada - Bus - De la Familia a Medellin.<br><strong>PM:</strong> Salida y llegada - Vuelo - Ron, Anyela y Nathan para Medellin.', type: 'event-travel', isBirthday: true, effect: 'birthday' },
                { date: '2026-01-16', icon: '🧳', description: 'Último día. Descanso y empacar.', type: 'event-tbd' },
                { date: '2026-01-17', icon: '🛫', description: '<strong>AM:</strong> Salida del resto del grupo desde Medellín a USA. Fin del viaje.', type: 'event-flight', flightInfo: { title: 'Vuelos de Regreso', flights: [{ num: 'CM209', route: 'Medellín → Panamá' }, { num: 'CM715', route: 'Panamá → Austin' }]}}
            ];
            itineraryData.sort((a, b) => new Date(a.date) - new Date(b.date));

            const timelineView = document.getElementById('timeline-view');
            const calendarView = document.getElementById('calendar-view');
            const showTimelineBtn = document.getElementById('show-timeline');
            const showCalendarBtn = document.getElementById('show-calendar');
            const dayFormatter = new Intl.DateTimeFormat('es-CO', { weekday: 'long', day: 'numeric', month: 'long' });

            function renderTimeline() {
                let html = '<h2>Diciembre 2025</h2>';
                let currentMonth = 11;
                const monthFormatter = new Intl.DateTimeFormat('es-CO', { month: 'long' });
                itineraryData.forEach(item => {
                    const itemDate = new Date(item.date + 'T12:00:00');
                    const itemMonth = itemDate.getMonth();
                    if (itemMonth !== currentMonth) {
                        html += `<h2>${monthFormatter.format(itemDate)} ${itemDate.getFullYear()}</h2>`;
                        currentMonth = itemMonth;
                    }
                    let flightHTML = '';
                    if(item.flightInfo) {
                        const buttons = item.flightInfo.flights.map(f => {
                            const airlineCode = f.num.replace(/\d/g, ''); const flightNum = f.num.replace(/\D/g, '');
                            return `<div class="flight-info"><a href="https://es.flightaware.com/live/flight/${airlineCode}${flightNum}" target="_blank" class="flight-button">✈️ Ver Vuelo ${f.num}</a><span class="flight-route">${f.route}</span></div>`;
                        }).join('');
                        flightHTML = `<div class="flight-tracker"><h4><span class="live-indicator"></span>Seguimiento de Vuelos en Vivo:</h4><div class="flight-buttons">${buttons}</div></div>`;
                    }
                    let labelHTML = '';
                    if (item.isBirthday) { labelHTML = '<span class="label-cumple">Cumpleaños de Faiber</span>'; }
                    else if (item.label) { labelHTML = `<span class="label-${item.label.toLowerCase()}">${item.label}</span>`; }

                    html += `<div class="timeline-item ${item.isHoliday ? 'festivo-item' : ''} ${item.effect ? 'effect-day' : ''}" data-id="${item.effect || ''}" data-icon="${item.icon}"><div class="item-content"><div class="item-date"><span>${dayFormatter.format(itemDate)}</span> ${labelHTML}</div><p class="item-description">${item.description}</p>${flightHTML}</div></div>`;
                });
                timelineView.innerHTML = html;
            }

            function renderCalendar(year, month) {
                const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
                const dayNames = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];
                const firstDay = new Date(year, month).getDay();
                const daysInMonth = 32 - new Date(year, month, 32).getDate();
                let html = `<h3>${monthNames[month]} ${year}</h3><div class="calendar-grid">`;
                dayNames.forEach(day => { html += `<div class="calendar-header">${day}</div>`; });
                for (let i = 0; i < firstDay; i++) { html += '<div class="calendar-day other-month"></div>'; }
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    const events = itineraryData.filter(item => item.date === dateStr);
                    let eventHTML = '';
                    if (events.length > 0) {
                        let labelHTML = '';
                        const eventWithLabel = events.find(e => e.label || e.isBirthday);
                        if(eventWithLabel) {
                            const labelClass = eventWithLabel.isBirthday ? 'label-cumple' : `label-${eventWithLabel.label.toLowerCase()}`;
                            const labelText = eventWithLabel.isBirthday ? 'Cumpleaños' : eventWithLabel.label;
                            labelHTML = `<div class="calendar-label"><span class="${labelClass}">${labelText}</span></div>`;
                        }
                        eventHTML = '<div class="event-icons-container">' + events.map(e => `<span class="calendar-emoji">${e.icon}</span>`).join('') + '</div>' + labelHTML;
                    }
                    html += `<div class="calendar-day ${events.length > 0 ? 'has-events' : ''} ${events.some(e => e.isHoliday) ? 'festivo-item' : ''}" data-date="${dateStr}"><div class="day-number">${day}</div>${eventHTML}</div>`;
                }
                html += '</div>';
                return html;
            }

            const calendarModal = document.getElementById('calendar-modal');
            const modalDate = document.getElementById('modal-date');
            const modalEvents = document.getElementById('modal-events');
            function openCalendarModal(date) {
                const events = itineraryData.filter(item => item.date === date);
                if (events.length === 0) return;
                const eventDate = new Date(date + 'T12:00:00');
                modalDate.innerText = dayFormatter.format(eventDate);
                let modalHTML = '';
                events.forEach(event => {
                    let flightHTML = '';
                    if(event.flightInfo) {
                        const buttons = event.flightInfo.flights.map(f => {
                           const airlineCode = f.num.replace(/\d/g, ''); const flightNum = f.num.replace(/\D/g, '');
                           return `<div class="flight-info"><a href="https://es.flightaware.com/live/flight/${airlineCode}${flightNum}" target="_blank" class="flight-button">✈️ Ver Vuelo ${f.num}</a><span class="flight-route">${f.route}</span></div>`;
                        }).join('');
                        flightHTML = `<div class="flight-tracker"><h4><span class="live-indicator"></span>Seguimiento de Vuelos en Vivo:</h4><div class="flight-buttons">${buttons}</div></div>`;
                    }
                    modalHTML += `<div class="item-description">${event.isBirthday ? '<span class="label-cumple">Cumpleaños de Faiber</span><br><br>' : ''}${event.description}</div>${flightHTML}`;
                });
                modalEvents.innerHTML = modalHTML;
                calendarModal.classList.add('popup-visible');
            }
            calendarView.addEventListener('click', (e) => {
                const dayElement = e.target.closest('.has-events');
                if (dayElement) { openCalendarModal(dayElement.dataset.date); }
            });
            calendarModal.querySelectorAll('.close-popup, .modal-close-button').forEach(el => {
                el.addEventListener('click', () => calendarModal.classList.remove('popup-visible'));
            });
            
            const privacyPopup = document.getElementById('privacy-popup');
            privacyPopup.querySelectorAll('.close-popup, .modal-close-button').forEach(el => {
                el.addEventListener('click', () => privacyPopup.classList.remove('popup-visible'));
            });
            [privacyPopup, calendarModal].forEach(popup => {
                popup.addEventListener('click', (e) => { if (e.target === popup) { popup.classList.remove('popup-visible'); } });
            });
            const revealDate = new Date('2026-01-04T12:00:00');
            if (new Date() < revealDate) {
                privacyPopup.classList.add('popup-visible');
            }
           
            renderTimeline();
            calendarView.innerHTML = renderCalendar(2025, 11) + renderCalendar(2026, 0);

            showTimelineBtn.addEventListener('click', () => {
                timelineView.classList.remove('view-hidden');
                calendarView.classList.add('view-hidden');
                showTimelineBtn.classList.add('active');
                showCalendarBtn.classList.remove('active');
            });
            showCalendarBtn.addEventListener('click', () => {
                calendarView.classList.remove('view-hidden');
                timelineView.classList.add('view-hidden');
                showCalendarBtn.classList.add('active');
                showTimelineBtn.classList.remove('active');
            });
            
            const cardNathan = document.getElementById('card-nathan');
            const cardRonAnyela = document.getElementById('card-ron-anyela');
            const createTimerHTML = (title, arrivalDate, idPrefix) => `<h3>${title}</h3><p class="arrival-date">${arrivalDate}</p><div class="timer" id="countdown-${idPrefix}"><div class="time-block"><span id="${idPrefix}-days">…</span><span>Días</span></div><div class="time-block"><span id="${idPrefix}-hours">…</span><span>Hrs</span></div><div class="time-block"><span id="${idPrefix}-minutes">…</span><span>Min</span></div><div class="time-block"><span id="${idPrefix}-seconds">…</span><span>Seg</span></div></div>`;
            cardNathan.innerHTML = createTimerHTML('Nathan llega en:', 'Sáb, 13 de Diciembre, 2025', 'nathan');
            cardRonAnyela.innerHTML = createTimerHTML('Anyela y Ron llegan en:', 'Sáb, 3 de Enero, 2026', 'ron-anyela');
            const nathanTargetUTC = new Date('2025-12-14T03:30:00Z').getTime();
            const ronAnyelaTargetUTC = new Date('2026-01-04T03:30:00Z').getTime();
            async function initializeClocks() {
                try {
                    const response = await fetch('https://worldtimeapi.org/api/timezone/Etc/UTC');
                    if (!response.ok) throw new Error('Error de red');
                    const data = await response.json();
                    let now_utc_from_api = new Date(data.utc_datetime).getTime();
                    setInterval(() => {
                        const distanceNathan = nathanTargetUTC - now_utc_from_api;
                        if (distanceNathan > 0) {
                            document.getElementById('nathan-days').innerText = Math.floor(distanceNathan / (1000 * 60 * 60 * 24));
                            document.getElementById('nathan-hours').innerText = Math.floor((distanceNathan % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            document.getElementById('nathan-minutes').innerText = Math.floor((distanceNathan % (1000 * 60 * 60)) / (1000 * 60));
                            document.getElementById('nathan-seconds').innerText = Math.floor((distanceNathan % (1000 * 60)) / 1000);
                        } else if (cardNathan.innerHTML.indexOf("aquí") === -1) {
                            cardNathan.innerHTML = "<h3>¡Ya están aquí!</h3>";
                        }
                        const distanceRonAnyela = ronAnyelaTargetUTC - now_utc_from_api;
                         if (distanceRonAnyela > 0) {
                            document.getElementById('ron-anyela-days').innerText = Math.floor(distanceRonAnyela / (1000 * 60 * 60 * 24));
                            document.getElementById('ron-anyela-hours').innerText = Math.floor((distanceRonAnyela % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            document.getElementById('ron-anyela-minutes').innerText = Math.floor((distanceRonAnyela % (1000 * 60 * 60)) / (1000 * 60));
                            document.getElementById('ron-anyela-seconds').innerText = Math.floor((distanceRonAnyela % (1000 * 60)) / 1000);
                        } else if (cardRonAnyela.innerHTML.indexOf("aquí") === -1) {
                            cardRonAnyela.innerHTML = "<h3>¡Ya están aquí!</h3>";
                        }
                        now_utc_from_api += 1000;
                    }, 1000);
                } catch (error){
                    cardNathan.innerHTML = `<h3>Sin conexión</h3><p style="font-size:0.9em;opacity:0.8;">Intente otra vez</p>`;
                    cardRonAnyela.innerHTML = `<h3>Sin conexión</h3><p style="font-size:0.9em;opacity:0.8;">Intente otra vez</p>`;
                }
            }
            async function loadWeatherWidgets() {
                const austin = { lat: 30.27, lon: -97.74, tz: 'America/Chicago', name: 'Austin, TX', el: document.getElementById('weather-austin') };
                const medellin = { lat: 6.25, lon: -75.58, tz: 'America/Bogota', name: 'Medellín', el: document.getElementById('weather-medellin') };
                const getWeatherIcon = (code) => {
                    if (code <= 1) return '☀️'; if (code === 2) return '🌥️'; if (code === 3) return '☁️';
                    if (code >= 51 && code <= 67) return '🌧️'; if (code >= 71 && code <= 77) return '❄️'; if (code >= 80 && code <= 82) return '🌦️';
                    if (code >= 95 && code <= 99) return '⛈️'; return '🌍';
                };
                const updateCity = async (city) => {
                    try {
                        const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current=temperature_2m,weather_code&timezone=${city.tz}`);
                        const data = await response.json();
                        const temp = Math.round(data.current.temperature_2m);
                        const icon = getWeatherIcon(data.current.weather_code);
                        const update = () => {
                            const time = new Intl.DateTimeFormat('es-CO', { timeZone: city.tz, hour: '2-digit', minute: '2-digit', hour12: true }).format(new Date());
                            city.el.innerHTML = `<div class="weather-card-left"><div class="city">${city.name}</div><div class="time">${time}</div></div><div class="weather-card-right"><div class="icon">${icon}</div><div class="temp">${temp}°C</div></div>`;
                        };
                        update();
                        setInterval(update, 60000);
                    } catch (error) { city.el.innerHTML = 'Error al cargar clima'; }
                };
                updateCity(austin);
                updateCity(medellin);
            }

            if (typeof confetti === 'function') {
                document.querySelectorAll('.effect-day').forEach(dayElement => {
                    const contentBox = dayElement.querySelector('.item-content');
                    if (!contentBox) return;
                    const canvas = document.createElement('canvas');
                    canvas.classList.add('effect-canvas');
                    contentBox.appendChild(canvas);

                    const myEffect = confetti.create(canvas, { resize: true, useWorker: true });
                    const type = dayElement.dataset.id;
                    
                    if (type === 'birthday') {
                        setInterval(() => myEffect({ particleCount: 1, startVelocity: 0, ticks: 300, origin: { x: Math.random(), y: (Math.random() * 0.7) + 0.1 }, gravity: 0.1, scalar: Math.random() * 0.4 + 0.8, drift: Math.random() - 0.5, colors: ['#bb0000', '#FFD700'] }), 400);
                    }
                });
            }
            
            initializeClocks();
            loadWeatherWidgets();
        });
    </script>
</body>
</html>
